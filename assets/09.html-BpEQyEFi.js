import{aq as s,ar as a,as as t,at as p}from"./app-Cok9BT0p.js";const e="/note-front/application/weixin/base/116.png",l="/note-front/application/weixin/base/117.png",o="/note-front/application/weixin/base/118.png",c="/note-front/application/weixin/base/119.png",i="/note-front/application/weixin/base/120.png",u={};function r(d,n){return p(),a("div",null,n[0]||(n[0]=[t('<h1 id="九、npm支持" tabindex="-1"><a class="header-anchor" href="#九、npm支持"><span>九、npm支持</span></a></h1><h2 id="_9-1-如何使用npm包" tabindex="-1"><a class="header-anchor" href="#_9-1-如何使用npm包"><span>9.1 如何使用npm包</span></a></h2><ol><li><p>介绍</p><p>目前小程序已经支持使用 npm 安装第三方包，因为 node_modules 目录中的包不会参与小程序项目的编译、上传和打包，因此在小程序项目中要使用的 npm 包，必须走一遍 构建 npm 的过程。</p><p>在构建成功以后，默认 会在小程序项目根目录也就是 node_modules 同级目录下生成 miniprogram_npm 目录,里面存放着构建完成以后的 npm 包，也就是小程序运行过程中真正使用的包</p></li><li><p>使用步骤</p><ol><li><p>进入终端</p><p><img src="'+e+`" alt=""></p></li><li><p>npm初始化</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">npm</span> init</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>下载vant webapp组件</p><ul><li><p><a href="https://vant.pro/vant-weapp/#/quickstart" target="_blank" rel="noopener noreferrer">进入网站</a></p></li><li><p>复制 npm 安装</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">npm</span> i @vant/weapp </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li><li><p>构建npm包</p><p><img src="`+l+'" alt=""></p></li><li><p>目录结果</p><p><img src="'+o+'" alt=""></p></li></ol></li><li><p>注意事项</p><p>小程序运行在微信内部，因为运行环境的特殊性，这就导致并不是所有的包都能在小程序中使用</p><p>我们在小程序中提到的包指专为小程序定制的 npm 包，简称小程序 npm 包，在使用包之前需要先确定该包是否支持小程序</p><p>开发者如果需要发布小程序包，<a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/npm.html" target="_blank" rel="noopener noreferrer">需要参考官方规范</a></p></li></ol><h2 id="_9-2-自定义构建-npm" tabindex="-1"><a class="header-anchor" href="#_9-2-自定义构建-npm"><span>9.2 自定义构建 npm</span></a></h2><ol><li><p>问题</p><p>在实际的开发中，随着项目的功能越来越多、项目越来越复杂，文件目录也变的很繁琐，为了方便进行项目的开发，开发人员通常会对目录结构进行调整优化，例如:将小程序源码放到 <code>miniprogram</code> 目录下</p><p>这时候需要开发者在 <code>project.config.json</code> 中指定 <code>node_modules</code> 的位置 和 目标 <code>miniprogram_npm</code> 的位置</p></li><li><p>具体配置如下</p><ol><li>配置 <code>project.config.json</code> 的 <code>miniprogramRoot</code> 指定小程序源码的目录</li><li>配置 <code>project.config.json</code> 的 <code>setting.packNpmManually </code>为 true，开启自定义 <code>node_modules</code> 和 <code>miniprogram_npm</code> 位置的构建 npm 方式</li><li>配置 <code>project.config.json</code> 的 <code>setting.packNpmRelationList</code> 项，指定 <code>packageJsonPath </code>和 <code>miniprogramNpmDistDir</code> 的位置.</li></ol></li><li><p>操作后的目录结构</p><p><img src="'+c+`" alt=""></p></li></ol><h2 id="_9-3-vant组件库的使用" tabindex="-1"><a class="header-anchor" href="#_9-3-vant组件库的使用"><span>9.3 vant组件库的使用</span></a></h2><ol><li><p>去除 <code>project.config.json</code> 配置中的 <code> &quot;style&quot;: &quot;v2&quot;,</code></p></li><li><p><a href="https://vant.pro/vant-weapp/#/image" target="_blank" rel="noopener noreferrer">UI页面中的使用方式</a></p></li><li><p>使用</p><ul><li><p>公共注册</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">&quot;usingComponents&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token property">&quot;van-image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@vant/weapp/image/index&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token property">&quot;van-loading&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@vant/weapp/loading/index&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>代码展示</p></li></ul><p>index.wxml</p><div class="language-xml line-numbers-mode" data-highlighter="prismjs" data-ext="xml"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-image</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://img.yzcdn.cn/vant/cat.jpeg<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span></span>
<span class="line"></span>
<span class="line"><span class="token comment">&lt;!-- 坑： --&gt;</span></span>
<span class="line"><span class="token comment">&lt;!-- 在使用 vant-image 图片组件时，如果需要渲染本地的图片，不能使用 ../ --&gt;</span></span>
<span class="line"><span class="token comment">&lt;!-- 需要相对于小程序源码的目录来查找图片才可以 --&gt;</span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-image</span> </span>
<span class="line">    <span class="token attr-name">round</span> </span>
<span class="line">    <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> </span>
<span class="line">    <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> </span>
<span class="line">    <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/assets/Jerry.png<span class="token punctuation">&quot;</span></span> </span>
<span class="line">    <span class="token attr-name"><span class="token namespace">bind:</span>click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>imageHandler<span class="token punctuation">&quot;</span></span></span>
<span class="line">    <span class="token attr-name">use-loading-slot</span></span>
<span class="line">    <span class="token attr-name">use-error-slot</span></span>
<span class="line">    <span class="token attr-name">custom-class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>custom-class<span class="token punctuation">&quot;</span></span></span>
<span class="line"><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token comment">&lt;!-- solt：loading  --&gt;</span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-loading</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loading<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>spinner<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20<span class="token punctuation">&quot;</span></span> <span class="token attr-name">vertical</span> <span class="token punctuation">/&gt;</span></span></span>
<span class="line"><span class="token comment">&lt;!-- solt：error  --&gt;</span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>error<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>加载失败<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-image</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../../assets/Jerry.png<span class="token punctuation">&quot;</span></span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>index.wxss</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code><span class="line"><span class="token selector">.custom-class</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">border</span><span class="token punctuation">:</span> 10rpx solid lightgreen <span class="token important">!important</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h2 id="_9-4-vant-weapp-组件样式覆盖" tabindex="-1"><a class="header-anchor" href="#_9-4-vant-weapp-组件样式覆盖"><span>9.4 vant Weapp 组件样式覆盖</span></a></h2><ol><li><p>介绍</p><p>Vant Weapp 基于微信小程序的机制，为开发者提供了3种修改组件样式的方法</p><ol><li>解除样式隔离:在页面中使用 Vant Weapp 组件时，可直接在页面的样式文件中覆盖样式</li><li>使用外部样式类:需要注意的是普通样式类和外部样式类的优先级是未定义的，使用时需要添加 imporant 保证外部样式类的优先级</li><li>使用 CSS 变量:在页面或全局对多个组件的样式做批量修改以进行主题样式的定制</li></ol></li><li><p>代码示例</p><ul><li><p>组件代码</p><p>app.wxss</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code><span class="line"><span class="token selector">page</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">--color</span><span class="token punctuation">:</span> lightskyblue<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>页面代码</p><p>cart.wxml</p><div class="language-xml line-numbers-mode" data-highlighter="prismjs" data-ext="xml"><pre><code><span class="line"><span class="token comment">&lt;!-- 外部样式类 --&gt;</span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-button</span>  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">custom-class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>custom-class<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>外部样式类<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-button</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span>
<span class="line"><span class="token comment">&lt;!-- 组件类-解除样式隔离 --&gt;</span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>custom01</span><span class="token punctuation">/&gt;</span></span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment">&lt;!-- 使用CSS变量：如果需要再多个页面或者一个组件中 需要批量修改组件、定制主题 --&gt;</span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">custom-class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>var-css<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>多个页面<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-button</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">custom-class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>var-css2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>my-button<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 一个组件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-button</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>cate.wxss</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code><span class="line"></span>
<span class="line"><span class="token selector">.van-button--primary.custom-class</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">font-size</span><span class="token punctuation">:</span> 28rpx <span class="token important">!important</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token property">background-color</span><span class="token punctuation">:</span> lightseagreen <span class="token important">!important</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token property">border</span><span class="token punctuation">:</span> 1px solid lightseagreen <span class="token important">!important</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token selector">.van-button--primary.var-css</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">font-size</span><span class="token punctuation">:</span> 28rpx <span class="token important">!important</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--color<span class="token punctuation">)</span> <span class="token important">!important</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token property">border</span><span class="token punctuation">:</span> 1px solid <span class="token function">var</span><span class="token punctuation">(</span>--color<span class="token punctuation">)</span> <span class="token important">!important</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token selector">.van-button--primary.var-css2</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">font-size</span><span class="token punctuation">:</span> 28rpx <span class="token important">!important</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--color2<span class="token punctuation">)</span> <span class="token important">!important</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token property">border</span><span class="token punctuation">:</span> 1px solid <span class="token function">var</span><span class="token punctuation">(</span>--color2<span class="token punctuation">)</span> <span class="token important">!important</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token selector">.my-button</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">--color2</span><span class="token punctuation">:</span> #ccc<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>组件代码</p><p>custom01.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">options</span><span class="token operator">:</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">styleIsolation</span><span class="token operator">:</span><span class="token string">&quot;shared&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>custom01.wxml</p><div class="language-xml line-numbers-mode" data-highlighter="prismjs" data-ext="xml"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>组件按钮<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-button</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>custom01.wxss</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code><span class="line"><span class="token comment">/* 在自定义组件中如果需要 Vant weapp 组件的样式，需要解除样式的隔离,shared */</span></span>
<span class="line"><span class="token selector">.van-button--primary</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">font-size</span><span class="token punctuation">:</span> 28rpx <span class="token important">!important</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token property">background-color</span><span class="token punctuation">:</span> lightcoral <span class="token important">!important</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token property">border</span><span class="token punctuation">:</span> 1px solid lightcoral <span class="token important">!important</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>运行结果</p><p><img src="`+i+'" alt=""></p></li></ul></li></ol>',9)]))}const k=s(u,[["render",r]]),v=JSON.parse('{"path":"/application/weixin/base/09.html","title":"九、npm支持","lang":"zh-CN","frontmatter":{},"git":{"updatedTime":1752490925000,"contributors":[{"name":"zhao-farmer","username":"zhao-farmer","email":"857899180@qq.com","commits":1,"url":"https://github.com/zhao-farmer"}],"changelog":[{"hash":"08d014805d6447d2221b34fe03fdc2ca18411d66","time":1752490925000,"email":"857899180@qq.com","author":"zhao-farmer","message":"2025年7月更新"}]},"filePathRelative":"application/weixin/base/09.md"}');export{k as comp,v as data};
