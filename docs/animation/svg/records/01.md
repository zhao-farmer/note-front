# 贝塞尔曲线详解



**d属性**

主要定义了路径的路径数据，由描述路径的一系列命令数据组成

> 命令数据主要由命令及命令参数组成，多个命令参数之间可用空格或逗号(英文逗号)隔开

## Q-二次贝塞尔曲线

该命令用于画**二次贝塞尔曲线**

`Q | q`后可跟`4`个参数：

1.  `x1`：控制点横坐标位置
2.  `y1`：控制点纵坐标位置
3.  `x`：终点横坐标位置
4.  `y`：终点纵坐标位置

> 四个参数两两一组，表示两组坐标，分别表示**控制点**坐标和**终点**坐标
> 
> 一条**二次贝塞尔曲线**其实就是由**起点**、**控制点**和**终点**三点经过某种规律运算决定的，其中，起点由上一次绘制的结束点决定
> 
> 其数学公式为：$B(t) = (1−t)^{2}P\alpha + 2t(1−t)P\beta + t^{2}P\gamma$ , $t \in [0,1]$
> 
> 本质上，是一系列点的集合

如下是一条二次贝塞尔曲线的绘制过程动画：

![curve-2](/animation/svg/records/image/001.gif)

接下来提取其中一帧进行标注分析，如下

![二次贝塞尔p](/animation/svg/records/image/002.png)

一条贝塞尔曲线由如图所示的一系列目标点B<sub>t</sub>组成

目标点 B<sub>t</sub> 又由 Q<sub>a</sub> 和 Q<sub>b</sub>  两点决定，其为两点连线的 T$\beta$ 处的点，其中Q<sub>a</sub> 由起点与控制点决定， Q<sub>b</sub>由控制点与终点决定，均为两点连线的 T$\gamma$ 处的点

故可总结得，贝塞尔曲线的绘制过程为：

*   在 $t \in [0,1]$ 中，每次取相邻两点连线的T$\alpha$ 处作为新的控制点
    
*   得出的新控制点继续取相邻两点连线的 T$\beta$ 处作为接下来的新控制点
    
*   以此递归，最终得出唯一的一个新控制点，即为组成贝塞尔曲线的点
    

> 起点与终点不之间不需要连线计算
> 
> 该流程也适用于高阶贝塞尔曲线
> 
> 用二次贝塞尔曲线论证，**三**个点经过一次运算即可得出**两**个新控制点，用新控制点再进行一次运算即可得出唯**一**的控制点，算出每个 $t \in [0,1]$ 下唯一的控制点，其集合成的线即为二阶贝塞尔曲线

当然，以上只是为了帮助认识贝塞尔曲线的生成过程，知其然，也知其所以然，如不想了解也是可以正常使用贝塞尔曲线的

言归正传，以下给出几条命令的示例：

*   `<path M100 450 Q300 150 500 450 />`
*   `<path M100 450 Q240 200 500 450 />`

如想知道命令长啥样，可自行在`svg`文件内运行查看

## T-平滑二次贝塞尔曲线

该命令用于画**平滑二次贝塞尔曲线**

`T | t`后可跟`2`个参数：

1.  `x`：终点横坐标位置
2.  `y`：终点纵坐标位置

> 其实，该命令本质上也是用于画二次贝塞尔曲线，可以算是`Q`命令的简化版
> 
> 只需要一个终点坐标即可生成曲线，但其实际上依旧由**起点**、**控制点**和**终点**三点生成，其中，**控制点**由上一次绘制的控制点关于其终点中心对称生成
> 
> 故，`T`命令只能接在`Q`或`T`命令后使用，如单独出现或接于其它命令后出现，控制点会与其起点一致，绘制的效果会是一条直线

![T](/animation/svg/records/image/003.png)


上图是一条曲线路径的示例图，由一次`Q`和两次`T`命令组成，其中`T`命令只需给出**终点**坐标即可，**控制点2**由**控制点1**绕**终点1**中心对称生成，**控制点3**由**控制点2**绕**终点2**中心对称生成

例：`<path d="M50 300 Q 160 180 240 270 T400 370 T500 240" fill="none" stroke="red" />`

## C-三次贝塞尔曲线

该命令用于画**三次贝塞尔曲线**

`C | c`后可跟`6`个参数：

1.  `x1`：控制点1横坐标位置
2.  `y1`：控制点1纵坐标位置
3.  `x2`：控制点2横坐标位置
4.  `y2`：控制点2纵坐标位置
5.  `x`：终点横坐标位置
6.  `y`：终点纵坐标位置

> 三次贝塞尔曲线比二次贝塞尔曲线多一个控制点控制，故有`6`个参数
> 
> 即其由**起点**、**控制点1**、**控制点2**和**终点**决定生成，生成方式与上方二次贝塞尔曲线讲的方式类似
> 
> 数学公式为：$B(t) = (1−t3)^{2}P\alpha + 3t(1−t)^{2}P\beta + 3t^{2}(1−t)P\gamma + t^{3}P\delta$, $t\in [0,1]$

以下是一条普通三次贝塞尔曲线的生成过程动画：

![curve-3](/animation/svg/records/image/004.gif)

具体的描述不再赘述

## S-平滑三次贝塞尔曲线

该命令用于画**平滑三次贝塞尔曲线**

`S | s`后可跟`4`个参数：

1.  `x1`：控制点2横坐标位置
2.  `y1`：控制点2纵坐标位置
3.  `x`：终点横坐标位置
4.  `y`：终点纵坐标位置

> 其为`C`命令的简化版，只需指定一个控制点2和终点坐标即可
> 
> 但其本质依旧是画三次贝塞尔曲线，实际上还是由**起点**、**控制点1**、**控制点2**和**终点**决定生成，其中，**控制点1**由上一次绘制的控制点关于其终点中心对称生成(即根据前一条命令的控制点2关于前一条命令的终点中心对称决定)

![C](/animation/svg/records/image/005.png)

上图是一条曲线路径的示例图，由一次`C`和两次`S`命令组成，其中`S`命令只需给出**控制点2**和**终点**坐标即可，**控制点b1**由**控制点a2**绕**终点a**中心对称生成，**控制点c1**由**控制点b2**绕**终点b**中心对称生成

例：`<path d="M50 300 C 160 180 240 210 300 300 S400 370 500 240 S660 160 700 300" fill="none" stroke="red" />`

## Z-闭合路径

该命令用于闭合路径，大小写字母均可，后面不需跟参数

命令会**从当前位置到起点画一条直线**闭合整个`path`

一般放在`d`属性命令数据的最后

## 名词解读

**绝对：** 指数值针对**坐标系**绝对

**相对：** 指数值针对**上一点**相对

> 对于`d`属性的命令，通常有大写字母和小写字母两种，大写表绝对，小写表相对

**贝塞尔曲线：** 是一种数学曲线，它拥有 **灵活、平滑、可编辑** 的特点，十分适合描述曲面形状、处理图形变形、模拟运动轨迹等场景


