
### 5.2.4 模板装饰器

`@defer` 是 Angular 16 引入的全新模板装饰器，用于实现组件的条件延迟加载，可以显著提升应用初始加载性能。


1. 基本语法结构

    ```html
    @defer (when condition) {
        <!-- 延迟加载的内容 -->
        <heavy-component />
    } @placeholder (minimum 500ms) {
        <!-- 加载前的占位内容 -->
        <div>Loading...</div>
    } @loading {
        <!-- 加载过程中显示 -->
        <spinner-component />
    } @error {
        <!-- 加载失败时显示 -->
        <div>Failed to load component</div>
    }
    ```

2. 触发条件（When Conditions）

    -  基于布尔条件

        ```html
        @defer (when isVisible) {
            <app-heavy-component />
        }
        ```

    -  基于视图端口可见性

        ```html
        @defer (on viewport) {
            <app-image-gallery />
        } @placeholder {
            <div class="placeholder">Scroll to see gallery</div>
        }
        ```

    - 基于交互事件

        ```html
        <button #trigger>Load Chart</button>

        @defer (on interaction(trigger)) {
            <app-data-chart />
        }
        ```

    - 基于定时器

        ```html
        @defer (on timer(5s)) {
            <app-recommendations />
        }
        ```

    - 组合条件

        ```html
        @defer (when shouldLoad; on viewport; prefetch on hover) {
            <app-heavy-component />
        }
        ```

