# 三、核心理解

## 3.1 目录结构

1. [进入官网指南](https://nuxt.com.cn/docs/4.x/guide)

2. 页面的目录结构

    ![](/framework/vue/nuxt/019.png)

3. 目录结构解释

    ```
    my-nuxt-app/
    ├── app/              # 应用核心代码（Nuxt 4 新增）
    │   ├── assest/       # 静态资源（文件中直接使用）
    │   ├── components/   # 自动导入的 Vue 组件
    │   ├── pages/        # 文件系统路由（自动生成）
    │   ├── layouts/      # 页面布局组件
    │   ├── composables/  # Composition API 逻辑
    │   ├── middleware/   # 路由中间件
    │   ├── plugins/      # 客户端插件
    │   ├── stores/       # 状态管理（如 Pinia）
    │   └── app.vue       # 应用根组件
    ├── server/           # 服务端代码（Nitro）
    ├── shared/           # 前后端共享代码（类型、工具）
    ├── public/           # 静态资源（直接映射到根路径）
    └── nuxt.config.ts    # 主配置文件（TypeScript 格式）
    ```

4. 静态资源引用

    - assets 资源的引用: ~ 或 @

        ```js
        // HTML 标签
        <img src="~assets/13.jpg"  style="height:100px;width:100px;" alt="">
        <img src="~/assets/13.jpg" style="height:100px;width:100px;" alt="">
        <img src="@/assets/13.jpg" style="height:100px;width:100px;" alt="">
        
        // CSS
        background-image: url(~assets/13.jpg);
        background-image: url(~/assets/13.jpg);
        background-image: url(@/assets/13.jpg);
        ```


    - public 目录资源的引用: / 直接引用

        ```js
        //html标签
        <img src="/12.jpg" style="height:100px;width:100px;" alt="">
        
        //css
        background-image: url(/12.jpg);
        ```


## 3.2 路由结构


1. 路由概述

    Nuxt.js 依据 pages 目录结构自动生成 vue-router 模块的路由配置。
    
    要在页面之间切换路由, 使用 `<nuxt-link>` 标签。

    | 标签名            | 描述            |
    |----------------|---------------|
    | `<nuxt-link>`    | nuxt.js 中切换路由 |
    | `<NuxtPage />`   | nuxt.js 的路由视图 |


2. 静态路由

    - 自动生成基础路由规则--静态路由

        | 路径        | 组件位置及其名称             | 规则             |
        |-----------|----------------------|----------------|
        | `/`         | `app/pages/index.vue`      | 默认文件 index.vue |
        | `/user`     | `app/pages/user/index.vue` | 默认文件 index.vue |
        | `/user/one` | `app/pages/user/one.vue`   | 指定文件           |


    - 实例
        1. 情况1：访问路径，由pages目录资源的名称组成（目录名称、文件的名称）
            - 资源位置： `app/pages/user/one.vue`
            - 访问路径：`http://localhost:3000/user/one`
        2. 情况2：每一个目录下，都有一个默认文件 index.vue
            - 资源位置： `app/pages/user/index.vue`
            - 访问路径：`http://localhost:3000/user`
        3. `/user` 可以匹配几种文件?
            - `pages/user.vue`        (优先级高)
            - `pages/user/index.vue` 文件

3. 动态路由

    - 介绍

        如果您在文件名中使用方括号 [ ]，它将被转换为 动态路由 参数。您可以在文件名或目录中混合使用多个参数，甚至是非动态文本。

        如果您希望参数是 可选的，必须使用双括号 [[]] 括起来，例如 `~/pages/[[slug]]/index.vue` 或 `~/pages/[[slug]].vue` 将匹配 / 。

    - 示例

        - 目录结构

            ```
            -| pages/
            ---| index.vue
            ---| users-[group]/
            -----| [id].vue
            ```
        - `pages/users-[group]/[id].vue`

            ```vue
            <template>
                <p>{{ $route.params.group }} - {{ $route.params.id }}</p>
            </template>
            ```

        - 路由 `/users-admins/123` 将渲染：

            ```vue
            <p>admins - 123</p>
            ```

4. 嵌套路由

    - 介绍

        可以使用 `<NuxtPage>` 显示 嵌套路由。

    - 示例
        - 目录结构

            ```
            -| pages/
            ---| parent/
            -----| child.vue
            ---| parent.vue
            ```
            
        - 文件树将生成以下路由：

            ```js
            [
                {
                    path: '/parent',
                    component: '~/pages/parent.vue',
                    name: 'parent',
                    children: [
                        {
                            path: 'child',
                            component: '~/pages/parent/child.vue',
                            name: 'parent-child'
                        }
                    ]
                }
            ]
            ```
        - 要显示 child.vue 组件，您需要在 pages/parent.vue 中插入 `<NuxtPage>` 组件：

            - `pages/parent.vue`

                ```vue
                <template>
                <div>
                    <h1>我是父视图</h1>
                    <NuxtPage :foobar="123" />
                </div>
                </template>
                ```
            - `pages/parent/child.vue`

                ```vue
                <script setup lang="ts">
                const props = defineProps(['foobar'])

                console.log(props.foobar)
                </script>
                ```

5. 自定义路由

    - 通过 router.options 扩展‌
        
        在 app/router.options.ts 中直接覆盖或扩展路由配置，支持 TypeScript 类型推断


            ```ts
            import type { RouterConfig } from '@nuxt/schema'
            export default {
                routes: (defaultRoutes) => [
                    ...defaultRoutes,
                    { path: '/custom', component: () => import('~/pages/custom.vue') }
                ]
            } satisfies RouterConfig
            ```
    - 使用 pages:extend 钩子‌
        
        在 nuxt.config.ts 中动态修改路由表，适合批量操作

            ```ts
            export default defineNuxtConfig({
                hooks: {
                    'pages:extend'(pages) {
                        pages.push({ name: 'admin', path: '/admin', file: '~/pages/admin.vue' })
                    }
                }
            })
            ```
    - 基础路径与分隔符‌
        - base‌：设置应用根路径（如部署在子目录时）

            ```ts
            export default defineNuxtConfig({
                router: { base: '/my-app/' }
            })
            ```
        - routeNameSplitter‌：修改路由名称分隔符（默认 -）

            ```ts
            export default defineNuxtConfig({
                router: { routeNameSplitter: '/' }
            })
            ```

## 3.3 布局结构

1. 默认布局‌：创建 app/layouts/default.vue 作为基础模板，通过 `<NuxtPage />` 渲染动态内容

    ```vue
    <template>
        <div>
            <Header />
            <main>
            <NuxtPage />
            </main>
            <Footer />
        </div>
    </template>
    ```
2. ‌自定义布局‌：新增文件如 app/layouts/admin.vue，通过 definePageMeta 指定使用：

    ```ts
    definePageMeta({ layout: 'admin' })
    ```